{"version":3,"sources":["Tank.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Tank extends cc.Component {\r\n\r\n    @property\r\n    maxSpeed: number = 0;\r\n\r\n    @property\r\n    accel: number = 0;\r\n\r\n    moveLeft: Boolean = false;\r\n    moveRight: Boolean = false;\r\n    isMove: Boolean = false;\r\n    leftMinX: number = 0;\r\n    rightMaxX: number = 0;\r\n    topMaxY: number = 0;\r\n    bottomMinY: number = 0;\r\n\r\n    tankMoveDirection(keyCode: number, isKeyDown: Boolean) {\r\n        switch (keyCode) {\r\n            case cc.macro.KEY.left:\r\n                this.moveLeft = isKeyDown;\r\n                this.isMove = isKeyDown;\r\n                break;\r\n            case cc.macro.KEY.right:\r\n                this.moveRight = isKeyDown;\r\n                this.isMove = isKeyDown;\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n\r\n    }\r\n\r\n    doTankMove() {\r\n        if (!this.isMove) return;\r\n        // 边界判断\r\n        if (this.moveLeft && this.node.x <= this.leftMinX) return;\r\n        if (this.moveRight && this.node.x >= this.rightMaxX) return;\r\n        //  移动\r\n        let moveValue = 4;\r\n        if (this.moveLeft) moveValue = moveValue * -1;\r\n        this.node.x += moveValue;\r\n    }\r\n    onTouchMove(e: cc.Event.EventTouch) {\r\n        let deltaX = e.getDeltaX();\r\n        let deltaY = e.getDeltaY();\r\n        //左移\r\n        if (deltaX < 0 && this.node.x <= this.leftMinX) return;\r\n        if (deltaX > 0 && this.node.x >= this.rightMaxX) return;\r\n        if (deltaY > 0 && this.node.y >= this.topMaxY) return;\r\n        if (deltaY < 0 && this.node.y <= this.bottomMinY) return;\r\n\r\n        this.node.x += deltaX;\r\n        this.node.y += deltaY;\r\n    }\r\n    onKeyDown(e: KeyboardEvent) {\r\n        this.tankMoveDirection(e.keyCode, true);\r\n    }\r\n    onKeyUp(e: KeyboardEvent) {\r\n        this.tankMoveDirection(e.keyCode, false);\r\n    }\r\n    start() {\r\n    }\r\n    onLoad() {\r\n        //计算边界信息\r\n        let { width, height } = cc.view.getDesignResolutionSize();\r\n        this.rightMaxX = (width - this.node.width) / 2;\r\n        this.leftMinX = -1 * this.rightMaxX;\r\n        this.topMaxY = (height - this.node.height) / 2;\r\n        this.bottomMinY = -1 * this.topMaxY + 75;\r\n\r\n        //注册事件监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\r\n        this.node.parent.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n    }\r\n    update(dt: number) {\r\n        this.doTankMove();\r\n    }\r\n}\r\n"]}