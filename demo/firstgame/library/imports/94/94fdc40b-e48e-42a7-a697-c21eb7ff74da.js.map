{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Star.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AACM,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAC5C,iCAA2B;AAG3B;IAAkC,wBAAY;IAD9C;QAAA,qEAkEC;QA9DG,WAAK,GAAU,IAAI,CAAC;QACpB,UAAI,GAAY,IAAI,CAAC;QACrB,UAAI,GAAW,EAAE,CAAC,IAAI,CAAC,uBAAuB,EAAE,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;IA4DjE,CAAC;IA1DG,oBAAK,GAAL;QACI,aAAa;QACb,IAAI,UAAU,GAAG,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC,CAAC;QAClF,UAAU,CAAC,MAAM,CAAC,EAAE,CAAC,WAAW,EAAE,CAAC,CAAC;QACpC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;IACpC,CAAC;IAED,yBAAU,GAAV;QACI,MAAM;QACN,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;QAC5B,IAAI,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC;QACrE,IAAI,QAAQ,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC,EAAE;YACtC,IAAI,CAAC,KAAK,CAAC,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC;YACjD,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;YACtD,QAAQ;YACR,IAAI,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,GAAG,CAAC,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,CAAC,EAAE;gBACxG,IAAI,CAAC,KAAK,CAAC,aAAa,IAAI,GAAG,CAAC;gBAChC,IAAI,IAAI,CAAC,KAAK,CAAC,gBAAgB,GAAG,GAAG,EAAE;oBACnC,IAAI,CAAC,KAAK,CAAC,gBAAgB,IAAI,GAAG,CAAC;iBACtC;gBACD,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,CAAC,CAAC;gBACxB,IAAI,IAAI,CAAC,KAAK,CAAC,cAAc,GAAG,EAAE,EAAE;oBAChC,IAAI,CAAC,KAAK,CAAC,cAAc,IAAI,CAAC,CAAC;iBAClC;aACJ;YACD,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,EAAE,KAAK,EAAE,GAAG,CAAC,CAAC;YACtD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAA;YACrE,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;SACvB;QACD,IAAI,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,EAAE;YAC1B,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,CAAC,CAAC;YACxB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC;YACpD,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YACpB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAA;YACrE,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,IAAI,CAAC,EAAE;gBACzB,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACvC,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;gBACtC,IAAI,CAAC,KAAK,CAAC,aAAa,GAAG,KAAK,CAAC;gBACjC,IAAI,YAAY,GAAG,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,CAAC;gBAC1E,IAAI,YAAY,IAAI,QAAQ,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE;oBAC9D,OAAO;iBACV;gBACD,EAAE,CAAC,GAAG,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,cAAc,EAAE,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;gBAC5E,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC;aAC9D;SACJ;IACL,CAAC;IACD,qBAAM,GAAN;IAEA,CAAC;IACD,qBAAM,GAAN,UAAO,EAAU;QACb,IAAI,IAAI,CAAC,KAAK,CAAC,aAAa,EAAE;YAC1B,IAAI,CAAC,UAAU,EAAE,CAAC;YAClB,OAAO;SACV;QACD,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAA,IAAI,IAAI,OAAA,IAAI,CAAC,cAAc,EAAE,EAArB,CAAqB,CAAC,CAAC;IAC/D,CAAC;IA5DD;QADC,QAAQ,CAAC,eAAK,CAAC;uCACI;IAHH,IAAI;QADxB,OAAO;OACa,IAAI,CAiExB;IAAD,WAAC;CAjED,AAiEC,CAjEiC,EAAE,CAAC,SAAS,GAiE7C;kBAjEoB,IAAI","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\nimport Index from \"./Index\"\r\n\r\n@ccclass\r\nexport default class Star extends cc.Component {\r\n\r\n    @property(Index)\r\n    index: Index = null;\r\n    tank: cc.Node = null;\r\n    minY: number = cc.view.getDesignResolutionSize().height / -2;\r\n\r\n    start() {\r\n        // 定义一个Action\r\n        let downAction = cc.moveTo(this.index.starFallSpeed, this.node.x, this.minY - 60);\r\n        downAction.easing(cc.easeSineOut());\r\n        this.node.runAction(downAction);\r\n    }\r\n\r\n    doMoveDown() {\r\n        //  检测\r\n        this.tank = this.index.tank;\r\n        let distance = this.node.position.sub(this.tank.getPosition()).mag();\r\n        if (distance < (this.tank.width / 2 - 5)) {\r\n            this.index.scoreNum += this.index.starScoreSpeed;\r\n            this.index.score.string = \"得分:\" + this.index.scoreNum;\r\n            // 降落速度加\r\n            if (Math.floor(this.index.scoreNum / 100) == this.index.starScoreSpeed - 4 && this.index.starFallSpeed > 1) {\r\n                this.index.starFallSpeed -= 0.2;\r\n                if (this.index.starBuildTimeOut > 200) {\r\n                    this.index.starBuildTimeOut -= 100;\r\n                }\r\n                this.index.lifeNum += 1;\r\n                if (this.index.starScoreSpeed < 10) {\r\n                    this.index.starScoreSpeed += 1;\r\n                }\r\n            }\r\n            cc.audioEngine.play(this.index.scoreClip, false, 0.2);\r\n            this.index.allStars.splice(this.index.allStars.indexOf(this.node), 1)\r\n            this.node.destroy();\r\n        }\r\n        if (this.node.y <= this.minY) {\r\n            this.index.lifeNum -= 1;\r\n            this.index.life.string = \"生命:\" + this.index.lifeNum;\r\n            this.node.destroy();\r\n            this.index.allStars.splice(this.index.allStars.indexOf(this.node), 1)\r\n            if (this.index.lifeNum <= 0) {\r\n                this.index.gameOver.node.active = true;\r\n                this.index.btnPlay.node.active = true;\r\n                this.index.starIsRunning = false;\r\n                let storageValue = cc.sys.localStorage.getItem(this.index.HIGHSTORAGEKEY);\r\n                if (storageValue && parseInt(storageValue) > this.index.scoreNum) {\r\n                    return;\r\n                }\r\n                cc.sys.localStorage.setItem(this.index.HIGHSTORAGEKEY, this.index.scoreNum);\r\n                this.index.highScore.string = \"最高分:\" + this.index.scoreNum;\r\n            }\r\n        }\r\n    }\r\n    onLoad() {\r\n\r\n    }\r\n    update(dt: number) {\r\n        if (this.index.starIsRunning) {\r\n            this.doMoveDown();\r\n            return;\r\n        }\r\n        this.index.allStars.forEach(node => node.stopAllActions());\r\n    }\r\n\r\n}\r\n"]}