{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Index.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Index extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    starPrefab: cc.Prefab = null;\r\n\r\n    @property(cc.Node)\r\n    tank: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    score: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    highScore: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    life: cc.Label = null;\r\n\r\n    @property(cc.AudioClip)\r\n    scoreClip: cc.AudioClip = null;\r\n\r\n    @property(cc.Label)\r\n    gameOver: cc.Label = null;\r\n\r\n    @property(cc.Button)\r\n    btnPlay: cc.Button = null;\r\n\r\n    allStars: cc.Node[] = [];\r\n\r\n    scoreNum: number = 0;\r\n    highScoreNum: number = 0;\r\n    lifeNum: number = 0;\r\n\r\n    starHeight: number = 0;\r\n    starWidth: number = 0;\r\n    starMaxY: number = 0;\r\n    starMinY: number = 0;\r\n    starMaxX: number = 0;\r\n    starMinX: number = 0;\r\n\r\n    defaultStarBuildSpeed: number = 1000;\r\n    defaultFallSpeed: number = 5;\r\n    defaultLifeNum: number = 10;\r\n    defaultScoreSpeed: number = 5;\r\n    HIGHSTORAGEKEY: String = \"TANK_HIGHSCORE\";\r\n\r\n    starBuildHandle: number = 0;\r\n    starBuildTimeOut: number = this.defaultStarBuildSpeed;\r\n    starFallSpeed = this.defaultFallSpeed;\r\n    starScoreSpeed = this.defaultScoreSpeed;\r\n    starIsRunning: Boolean = false;\r\n\r\n    buildOneStar() {\r\n        let star = cc.instantiate(this.starPrefab);\r\n        this.node.addChild(star);\r\n        if (this.starWidth == 0) {\r\n            this.starWidth = star.width;\r\n            this.starHeight = star.height;\r\n            let vs = cc.view.getDesignResolutionSize();\r\n            this.starMaxY = Math.floor((vs.height - this.starHeight) / 2);\r\n            this.starMinY = this.tank.getPosition().y;\r\n            this.starMaxX = Math.floor((vs.width - this.starWidth) / 2);\r\n            this.starMinX = -this.starMaxX;\r\n        }\r\n        // 保存当前对象\r\n        this.allStars.push(star);\r\n        return star;\r\n    }\r\n    buildRandomStar() {\r\n        let tempX = 0;\r\n        let tempY = 0;\r\n        tempX = Math.floor(this.starMaxX - Math.random() * this.starMaxX);\r\n        tempY = Math.floor(this.starMaxY - Math.random() * this.starMaxY);\r\n        if (Math.random() < 0.5) tempX = tempX * -1;\r\n        let star = this.buildOneStar();\r\n        star.setPosition(tempX, tempY);\r\n        star.zIndex = this.tank.zIndex - 1;\r\n        star.name = \"star\";\r\n        star.getComponent(\"Star\").index = this;\r\n    }\r\n    buildStarForever() {\r\n        if (this.starIsRunning) {\r\n            this.starBuildHandle = setTimeout(() => {\r\n                clearTimeout(this.starBuildHandle);\r\n                this.buildRandomStar();\r\n                this.buildStarForever();\r\n            }, this.starBuildTimeOut);\r\n        }\r\n    }\r\n    initResource() {\r\n        this.scoreNum = 0;\r\n        this.score.string = \"得分:\" + this.scoreNum;\r\n        this.lifeNum = this.defaultLifeNum;\r\n        this.life.string = \"生命:\" + this.lifeNum;\r\n        this.highScoreNum = 0;\r\n        let storageValue = cc.sys.localStorage.getItem(this.HIGHSTORAGEKEY);\r\n        if (storageValue) {\r\n            this.highScoreNum = parseInt(storageValue);\r\n        }\r\n        this.highScore.string = \"最高分:\" + this.highScoreNum;\r\n        this.gameOver.node.active = false;\r\n        //清空缓存星星\r\n        this.allStars.forEach(item => item.destroy());\r\n        this.allStars = [];\r\n        this.starBuildTimeOut = this.defaultStarBuildSpeed;\r\n        this.starFallSpeed = this.defaultFallSpeed;\r\n        this.starScoreSpeed = this.defaultScoreSpeed;\r\n    }\r\n\r\n    onBtnPlayClick(e: cc.Event.EventTouch) {\r\n        this.initResource();\r\n        this.btnPlay.node.active = false;\r\n        this.starIsRunning = true;\r\n        // 开始生产星星\r\n        this.buildStarForever();\r\n    }\r\n    onLoad() {\r\n        this.gameOver.node.active = false;\r\n        this.tank.zIndex = 1;\r\n        this.gameOver.node.zIndex = 3;\r\n        this.btnPlay.node.zIndex = 3;\r\n        this.life.node.zIndex = 3;\r\n        this.score.node.zIndex = 3;\r\n        // 注册按事件\r\n        this.btnPlay.node.on(cc.Node.EventType.TOUCH_END, this.onBtnPlayClick.bind(this), false);\r\n        //注册广告\r\n        if (typeof wx === 'undefined') {\r\n            return;\r\n        }\r\n        let bannerAd = wx.createBannerAd({\r\n            adUnitId: 'adunit-a6715e39b68734d4',\r\n            adIntervals: 30,\r\n            style: {\r\n                left: wx.getSystemInfoSync().windowWidth / 2 - 150,\r\n                top: wx.getSystemInfoSync().windowHeight - 105,\r\n                width: 300\r\n            }\r\n        })\r\n        bannerAd.show()\r\n\r\n    }\r\n    update(dt: number) {\r\n\r\n    }\r\n    start() {\r\n    }\r\n\r\n}\r\n"]}